<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 2000">
  <defs>
    <linearGradient id="employeeBg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#E3F2FD"/>
      <stop offset="100%" style="stop-color:#BBDEFB"/>
    </linearGradient>
    <linearGradient id="serverBg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#E8F5E9"/>
      <stop offset="100%" style="stop-color:#C8E6C9"/>
    </linearGradient>
    <linearGradient id="storageBg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FFF3E0"/>
      <stop offset="100%" style="stop-color:#FFE0B2"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="4" flood-opacity="0.3"/>
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="2000" fill="#FAFAFA"/>

  <!-- Title -->
  <text x="700" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#1A237E">
    –°–∏—Å—Ç–µ–º–∞ #10: –ß–∞—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (Employee Chat)
  </text>
  <text x="700" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#666">
    –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –º–µ–∂–¥—É —Å–æ–±–æ–π
  </text>

  <!-- ==================== VISUAL SCHEMA ==================== -->

  <!-- Chat Types Section -->
  <rect x="50" y="120" width="1300" height="180" rx="15" fill="url(#storageBg)" filter="url(#shadow)"/>
  <text x="700" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#E65100">
    –¢–ò–ü–´ –ß–ê–¢–û–í (EmployeeChatType)
  </text>

  <!-- General Chat -->
  <rect x="70" y="175" width="380" height="100" rx="10" fill="white" stroke="#2196F3" stroke-width="2"/>
  <text x="260" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="24">üåê</text>
  <text x="260" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2196F3">GENERAL (–û–±—â–∏–π —á–∞—Ç)</text>
  <text x="260" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">–î–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º</text>
  <text x="260" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">–û–±—â–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è, –≤–æ–ø—Ä–æ—Å—ã</text>

  <!-- Shop Chat -->
  <rect x="510" y="175" width="380" height="100" rx="10" fill="white" stroke="#FF9800" stroke-width="2"/>
  <text x="700" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="24">üè™</text>
  <text x="700" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FF9800">SHOP (–ß–∞—Ç –º–∞–≥–∞–∑–∏–Ω–∞)</text>
  <text x="700" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">–ü—Ä–∏–≤—è–∑–∞–Ω –∫ shopAddress</text>
  <text x="700" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">–û–±—â–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ –º–∞–≥–∞–∑–∏–Ω–∞</text>

  <!-- Private Chat -->
  <rect x="950" y="175" width="380" height="100" rx="10" fill="white" stroke="#4CAF50" stroke-width="2"/>
  <text x="1140" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="24">üë§</text>
  <text x="1140" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#4CAF50">PRIVATE (–õ–∏—á–Ω—ã–π —á–∞—Ç)</text>
  <text x="1140" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">–ú–µ–∂–¥—É –¥–≤—É–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏</text>
  <text x="1140" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">participants: [phone1, phone2]</text>

  <!-- Employee Section -->
  <rect x="50" y="320" width="600" height="450" rx="15" fill="url(#employeeBg)" filter="url(#shadow)"/>
  <text x="350" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1565C0">
    –°–û–¢–†–£–î–ù–ò–ö (Employee App)
  </text>

  <!-- Chats List Page -->
  <rect x="70" y="375" width="260" height="180" rx="10" fill="white" stroke="#1565C0" stroke-width="2"/>
  <text x="200" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565C0">EmployeeChatsListPage</text>
  <text x="90" y="425" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —á–∞—Ç–æ–≤</text>
  <text x="90" y="445" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –°—á—ë—Ç—á–∏–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö</text>
  <text x="90" y="465" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –ü—Ä–µ–≤—å—é –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ msg</text>
  <text x="90" y="485" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ 10 —Å–µ–∫</text>
  <text x="90" y="505" font-family="Arial, sans-serif" font-size="11" fill="#666">‚Ä¢ FAB: + –Ω–æ–≤—ã–π —á–∞—Ç</text>
  <rect x="90" y="520" width="80" height="25" rx="5" fill="#E3F2FD" stroke="#1565C0"/>
  <text x="130" y="537" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#1565C0">unread: 5</text>
  <text x="200" y="548" font-family="Arial, sans-serif" font-size="10" fill="#C62828">‚Üê Badge</text>

  <!-- Chat Page -->
  <rect x="350" y="375" width="280" height="180" rx="10" fill="white" stroke="#1565C0" stroke-width="2"/>
  <text x="490" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565C0">EmployeeChatPage</text>
  <text x="370" y="425" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞</text>
  <text x="370" y="445" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞</text>
  <text x="370" y="465" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ</text>
  <text x="370" y="485" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ 5 —Å–µ–∫</text>
  <text x="370" y="505" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª –∫ –Ω–æ–≤—ã–º</text>
  <text x="370" y="525" font-family="Arial, sans-serif" font-size="11" fill="#666">‚Ä¢ markAsRead –ø—Ä–∏ –≤—Ö–æ–¥–µ</text>

  <!-- New Chat Page -->
  <rect x="70" y="565" width="260" height="100" rx="10" fill="white" stroke="#1565C0" stroke-width="2"/>
  <text x="200" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565C0">NewChatPage</text>
  <text x="90" y="615" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</text>
  <text x="90" y="635" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ private —á–∞—Ç–∞</text>
  <text x="90" y="655" font-family="Arial, sans-serif" font-size="11" fill="#666">‚Ä¢ getOrCreatePrivateChat()</text>

  <!-- Widgets -->
  <rect x="350" y="565" width="280" height="100" rx="10" fill="white" stroke="#1565C0" stroke-width="2"/>
  <text x="490" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565C0">Widgets</text>
  <text x="370" y="615" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ ChatMessageBubble</text>
  <text x="370" y="635" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ ChatInputField</text>
  <text x="370" y="655" font-family="Arial, sans-serif" font-size="11" fill="#666">‚Ä¢ ImagePicker integration</text>

  <!-- Message Flow -->
  <rect x="70" y="675" width="560" height="80" rx="10" fill="#E8EAF6" stroke="#3F51B5" stroke-width="2"/>
  <text x="350" y="700" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#3F51B5">–ü–æ—Ç–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π</text>
  <text x="90" y="725" font-family="Arial, sans-serif" font-size="11" fill="#333">1. –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞/–≤—ã–±–æ—Ä —Ñ–æ—Ç–æ ‚Üí 2. uploadMessagePhoto() ‚Üí 3. sendMessage() ‚Üí 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞</text>
  <text x="90" y="745" font-family="Arial, sans-serif" font-size="11" fill="#666">–§–æ—Ç–æ: ImagePicker ‚Üí MultipartRequest ‚Üí /upload-media ‚Üí imageUrl ‚Üí sendMessage</text>

  <!-- Arrow to Server -->
  <path d="M 650 500 L 700 500" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" fill="none"/>

  <!-- Server Section -->
  <rect x="720" y="320" width="630" height="450" rx="15" fill="url(#serverBg)" filter="url(#shadow)"/>
  <text x="1035" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#2E7D32">
    –°–ï–†–í–ï–† (API)
  </text>

  <!-- API Endpoints -->
  <rect x="740" y="375" width="590" height="260" rx="10" fill="white" stroke="#2E7D32" stroke-width="2"/>
  <text x="1035" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2E7D32">API Endpoints (/api/employee-chats)</text>

  <text x="760" y="430" font-family="monospace" font-size="11" fill="#333">GET  /api/employee-chats?phone=xxx</text>
  <text x="770" y="450" font-family="Arial, sans-serif" font-size="10" fill="#666">‚Üí –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</text>

  <text x="760" y="475" font-family="monospace" font-size="11" fill="#333">GET  /api/employee-chats/:chatId/messages?phone=xxx&amp;limit=50</text>
  <text x="770" y="495" font-family="Arial, sans-serif" font-size="10" fill="#666">‚Üí –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ (—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π)</text>

  <text x="760" y="520" font-family="monospace" font-size="11" fill="#333">POST /api/employee-chats/:chatId/messages</text>
  <text x="770" y="540" font-family="Arial, sans-serif" font-size="10" fill="#666">‚Üí body: {senderPhone, senderName, text, imageUrl?}</text>

  <text x="760" y="565" font-family="monospace" font-size="11" fill="#333">POST /api/employee-chats/:chatId/read</text>
  <text x="770" y="585" font-family="Arial, sans-serif" font-size="10" fill="#666">‚Üí body: {phone} - –æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ</text>

  <text x="760" y="610" font-family="monospace" font-size="11" fill="#333">POST /api/employee-chats/private</text>
  <text x="770" y="630" font-family="Arial, sans-serif" font-size="10" fill="#666">‚Üí body: {phone1, phone2} - —Å–æ–∑–¥–∞—Ç—å/–ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç</text>

  <!-- Storage -->
  <rect x="740" y="645" width="590" height="110" rx="10" fill="white" stroke="#2E7D32" stroke-width="2"/>
  <text x="1035" y="670" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2E7D32">–•—Ä–∞–Ω–∏–ª–∏—â–µ</text>
  <text x="760" y="695" font-family="monospace" font-size="11" fill="#333">/root/arabica_app/data/employee-chats/</text>
  <text x="770" y="715" font-family="monospace" font-size="10" fill="#666">‚îú‚îÄ‚îÄ chats.json (—Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤)</text>
  <text x="770" y="735" font-family="monospace" font-size="10" fill="#666">‚îî‚îÄ‚îÄ messages/:chatId.json (—Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞)</text>
  <text x="760" y="750" font-family="monospace" font-size="11" fill="#333">/root/arabica_app/uploads/ (—Ñ–æ—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–π)</text>

  <!-- ==================== DETAILED DESCRIPTION ==================== -->

  <rect x="50" y="790" width="1300" height="1180" rx="15" fill="white" stroke="#1A237E" stroke-width="2" filter="url(#shadow)"/>
  <text x="700" y="825" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1A237E">
    –î–ï–¢–ê–õ–¨–ù–û–ï –û–ü–ò–°–ê–ù–ò–ï –°–ò–°–¢–ï–ú–´ –ß–ê–¢–ê
  </text>

  <!-- EmployeeChat Model -->
  <rect x="70" y="850" width="600" height="220" rx="10" fill="#E3F2FD" stroke="#1976D2" stroke-width="2"/>
  <text x="370" y="875" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1976D2">
    EmployeeChat (–ú–æ–¥–µ–ª—å —á–∞—Ç–∞)
  </text>
  <text x="90" y="905" font-family="monospace" font-size="11" fill="#333">class EmployeeChat {</text>
  <text x="100" y="925" font-family="monospace" font-size="11" fill="#333">  String id;              // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —á–∞—Ç–∞</text>
  <text x="100" y="945" font-family="monospace" font-size="11" fill="#333">  EmployeeChatType type;  // general | shop | private</text>
  <text x="100" y="965" font-family="monospace" font-size="11" fill="#333">  String name;            // –ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞</text>
  <text x="100" y="985" font-family="monospace" font-size="11" fill="#333">  String? shopAddress;    // –î–ª—è shop —Ç–∏–ø–∞</text>
  <text x="100" y="1005" font-family="monospace" font-size="11" fill="#333">  List&lt;String&gt; participants; // –¢–µ–ª–µ—Ñ–æ–Ω—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</text>
  <text x="100" y="1025" font-family="monospace" font-size="11" fill="#333">  int unreadCount;        // –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</text>
  <text x="100" y="1045" font-family="monospace" font-size="11" fill="#333">  EmployeeChatMessage? lastMessage; // –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</text>
  <text x="90" y="1065" font-family="monospace" font-size="11" fill="#333">}</text>

  <!-- EmployeeChatMessage Model -->
  <rect x="690" y="850" width="640" height="220" rx="10" fill="#E8F5E9" stroke="#388E3C" stroke-width="2"/>
  <text x="1010" y="875" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#388E3C">
    EmployeeChatMessage (–ú–æ–¥–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏—è)
  </text>
  <text x="710" y="905" font-family="monospace" font-size="11" fill="#333">class EmployeeChatMessage {</text>
  <text x="720" y="925" font-family="monospace" font-size="11" fill="#333">  String id;           // UUID —Å–æ–æ–±—â–µ–Ω–∏—è</text>
  <text x="720" y="945" font-family="monospace" font-size="11" fill="#333">  String chatId;       // ID —á–∞—Ç–∞</text>
  <text x="720" y="965" font-family="monospace" font-size="11" fill="#333">  String senderPhone;  // –¢–µ–ª–µ—Ñ–æ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è</text>
  <text x="720" y="985" font-family="monospace" font-size="11" fill="#333">  String senderName;   // –ò–º—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è</text>
  <text x="720" y="1005" font-family="monospace" font-size="11" fill="#333">  String text;         // –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è</text>
  <text x="720" y="1025" font-family="monospace" font-size="11" fill="#333">  String? imageUrl;    // URL —Ñ–æ—Ç–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</text>
  <text x="720" y="1045" font-family="monospace" font-size="11" fill="#333">  DateTime timestamp;  // –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏</text>
  <text x="720" y="1065" font-family="monospace" font-size="11" fill="#333">  List&lt;String&gt; readBy; // –ö—Ç–æ –ø—Ä–æ—á–∏—Ç–∞–ª (—Ç–µ–ª–µ—Ñ–æ–Ω—ã)</text>

  <!-- Flutter Files -->
  <rect x="70" y="1085" width="600" height="220" rx="10" fill="#F3E5F5" stroke="#7B1FA2" stroke-width="2"/>
  <text x="370" y="1110" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#7B1FA2">
    Flutter —Ñ–∞–π–ª—ã
  </text>

  <text x="90" y="1140" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#7B1FA2">Pages:</text>
  <text x="100" y="1160" font-family="monospace" font-size="10" fill="#333">lib/features/employee_chat/pages/employee_chats_list_page.dart</text>
  <text x="100" y="1180" font-family="monospace" font-size="10" fill="#333">lib/features/employee_chat/pages/employee_chat_page.dart</text>
  <text x="100" y="1200" font-family="monospace" font-size="10" fill="#333">lib/features/employee_chat/pages/new_chat_page.dart</text>

  <text x="90" y="1225" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#7B1FA2">Services:</text>
  <text x="100" y="1245" font-family="monospace" font-size="10" fill="#333">lib/features/employee_chat/services/employee_chat_service.dart</text>

  <text x="90" y="1270" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#7B1FA2">Models &amp; Widgets:</text>
  <text x="100" y="1290" font-family="monospace" font-size="10" fill="#333">lib/features/employee_chat/models/employee_chat_model.dart</text>
  <text x="100" y="1310" font-family="monospace" font-size="10" fill="#333">lib/features/employee_chat/models/employee_chat_message_model.dart</text>
  <text x="100" y="1330" font-family="monospace" font-size="10" fill="#333">lib/features/employee_chat/widgets/chat_message_bubble.dart</text>
  <text x="100" y="1350" font-family="monospace" font-size="10" fill="#333">lib/features/employee_chat/widgets/chat_input_field.dart</text>

  <!-- Features -->
  <rect x="690" y="1085" width="640" height="220" rx="10" fill="#FFF8E1" stroke="#FF8F00" stroke-width="2"/>
  <text x="1010" y="1110" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FF8F00">
    –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
  </text>

  <text x="710" y="1140" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#FF8F00">Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</text>
  <text x="720" y="1160" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤: Timer.periodic(10 —Å–µ–∫)</text>
  <text x="720" y="1180" font-family="Arial, sans-serif" font-size="11" fill="#333">‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏—è: Timer.periodic(5 —Å–µ–∫)</text>
  <text x="720" y="1200" font-family="Arial, sans-serif" font-size="11" fill="#666">‚Ä¢ Silent mode: –±–µ–∑ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏</text>

  <text x="710" y="1230" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#FF8F00">–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ:</text>
  <text x="720" y="1250" font-family="Arial, sans-serif" font-size="11" fill="#333">1. ImagePicker.pickImage() ‚Üí File</text>
  <text x="720" y="1270" font-family="Arial, sans-serif" font-size="11" fill="#333">2. uploadMessagePhoto() ‚Üí POST /upload-media</text>
  <text x="720" y="1290" font-family="Arial, sans-serif" font-size="11" fill="#333">3. –ü–æ–ª—É—á–∞–µ–º URL ‚Üí sendMessage(imageUrl: url)</text>

  <!-- Important Notes -->
  <rect x="70" y="1320" width="1260" height="200" rx="10" fill="#FFEBEE" stroke="#C62828" stroke-width="2"/>
  <text x="700" y="1345" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#C62828">
    –í–ê–ñ–ù–´–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò
  </text>

  <text x="90" y="1375" font-family="Arial, sans-serif" font-size="12" fill="#333">1. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É (user_phone –∏–∑ SharedPreferences)</text>
  <text x="90" y="1400" font-family="Arial, sans-serif" font-size="12" fill="#333">2. –ò–º—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è: –±–µ—Ä—ë—Ç—Å—è –∏–∑ EmployeesPage.getCurrentEmployeeName() (–µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã)</text>
  <text x="90" y="1425" font-family="Arial, sans-serif" font-size="12" fill="#333">3. –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è: unreadCount —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è badge –≤ —Å–ø–∏—Å–∫–µ</text>
  <text x="90" y="1450" font-family="Arial, sans-serif" font-size="12" fill="#333">4. –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª: –∫ –Ω–æ–≤—ã–º —Å–æ–æ–±—â–µ–Ω–∏—è–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –≤–Ω–∏–∑—É —Å–ø–∏—Å–∫–∞</text>
  <text x="90" y="1475" font-family="Arial, sans-serif" font-size="12" fill="#333">5. –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç: —Å–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ getOrCreatePrivateChat(phone1, phone2) - –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ</text>
  <text x="90" y="1500" font-family="Arial, sans-serif" font-size="12" fill="#333">6. –ß–∞—Ç –º–∞–≥–∞–∑–∏–Ω–∞: —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ getOrCreateShopChat(shopAddress)</text>

  <!-- Message Flow Diagram -->
  <rect x="70" y="1535" width="1260" height="230" rx="10" fill="#E8EAF6" stroke="#3F51B5" stroke-width="2"/>
  <text x="700" y="1560" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#3F51B5">
    –°–•–ï–ú–ê –û–¢–ü–†–ê–í–ö–ò –°–û–û–ë–©–ï–ù–ò–Ø
  </text>

  <!-- Flow boxes -->
  <rect x="90" y="1580" width="150" height="60" rx="8" fill="#C5CAE9"/>
  <text x="165" y="1605" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#3F51B5">User Input</text>
  <text x="165" y="1625" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">—Ç–µ–∫—Å—Ç / —Ñ–æ—Ç–æ</text>

  <path d="M 240 1610 L 280 1610" stroke="#3F51B5" stroke-width="2" marker-end="url(#arrowhead)"/>

  <rect x="280" y="1580" width="180" height="60" rx="8" fill="#C5CAE9"/>
  <text x="370" y="1605" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#3F51B5">Photo Upload</text>
  <text x="370" y="1625" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">POST /upload-media</text>

  <path d="M 460 1610 L 500 1610" stroke="#3F51B5" stroke-width="2" marker-end="url(#arrowhead)"/>

  <rect x="500" y="1580" width="180" height="60" rx="8" fill="#C5CAE9"/>
  <text x="590" y="1605" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#3F51B5">Send Message</text>
  <text x="590" y="1625" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">POST .../messages</text>

  <path d="M 680 1610 L 720 1610" stroke="#3F51B5" stroke-width="2" marker-end="url(#arrowhead)"/>

  <rect x="720" y="1580" width="180" height="60" rx="8" fill="#A5D6A7"/>
  <text x="810" y="1605" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2E7D32">Server Store</text>
  <text x="810" y="1625" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">messages/:chatId.json</text>

  <path d="M 900 1610 L 940 1610" stroke="#2E7D32" stroke-width="2" marker-end="url(#arrowhead)"/>

  <rect x="940" y="1580" width="180" height="60" rx="8" fill="#A5D6A7"/>
  <text x="1030" y="1605" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2E7D32">Broadcast</text>
  <text x="1030" y="1625" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">polling by other users</text>

  <path d="M 1120 1610 L 1160 1610" stroke="#2E7D32" stroke-width="2" marker-end="url(#arrowhead)"/>

  <rect x="1160" y="1580" width="150" height="60" rx="8" fill="#FFCC80"/>
  <text x="1235" y="1605" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#E65100">UI Update</text>
  <text x="1235" y="1625" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">–Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</text>

  <!-- Read status flow -->
  <rect x="90" y="1660" width="1220" height="90" rx="8" fill="#E1F5FE"/>
  <text x="700" y="1685" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#0277BD">–û—Ç–º–µ—Ç–∫–∞ –æ –ø—Ä–æ—á—Ç–µ–Ω–∏–∏</text>

  <text x="110" y="1710" font-family="Arial, sans-serif" font-size="11" fill="#333">1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —á–∞—Ç</text>
  <path d="M 290 1710 L 330 1710" stroke="#0277BD" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="350" y="1710" font-family="Arial, sans-serif" font-size="11" fill="#333">2. markAsRead(chatId, phone)</text>
  <path d="M 540 1710 L 580 1710" stroke="#0277BD" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="600" y="1710" font-family="Arial, sans-serif" font-size="11" fill="#333">3. –°–µ—Ä–≤–µ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç phone –≤ readBy</text>
  <path d="M 840" y="1710" L 880 1710" stroke="#0277BD" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="900" y="1710" font-family="Arial, sans-serif" font-size="11" fill="#333">4. unreadCount –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è</text>

  <text x="110" y="1740" font-family="Arial, sans-serif" font-size="10" fill="#666">isReadBy(phone): –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω –≤ —Å–ø–∏—Å–∫–µ readBy —Å–æ–æ–±—â–µ–Ω–∏—è</text>

</svg>
