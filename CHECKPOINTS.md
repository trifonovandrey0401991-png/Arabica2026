# Система контрольных точек

Эта система позволяет быстро создавать контрольные точки и откатываться к предыдущим версиям приложения.

## Быстрый старт

### Создать контрольную точку:
```bash
./create_checkpoint.sh v1.1-stable "Описание изменений"
```

Или без указания имени (автоматически с датой):
```bash
./create_checkpoint.sh
```

### Посмотреть все контрольные точки:
```bash
git tag -l
```

### Откатиться к контрольной точке:
```bash
./restore_checkpoint.sh v1.0-stable
```

### Вернуться к последней версии:
```bash
git checkout main
```

## Скрипты

### `create_checkpoint.sh`
Создает Git тег для текущей версии кода.

**Использование:**
```bash
./create_checkpoint.sh [имя_тега] [описание]
```

**Примеры:**
```bash
# С автоматическим именем
./create_checkpoint.sh

# С указанием имени
./create_checkpoint.sh v1.2-stable

# С именем и описанием
./create_checkpoint.sh v1.2-stable "Добавлена новая функция"
```

### `restore_checkpoint.sh`
Откатывает код к указанной контрольной точке.

**Использование:**
```bash
./restore_checkpoint.sh [имя_тега]
```

**Пример:**
```bash
./restore_checkpoint.sh v1.0-stable
```

**Важно:** Перед откатом создается резервная копия текущего состояния в отдельной ветке.

### `backup_proxy.sh`
Создает бэкап конфигурации прокси-сервера.

**Использование:**
```bash
./backup_proxy.sh
```

Бэкапы сохраняются в `/root/loyalty-proxy/backups/` с временной меткой.

## Рекомендации

1. **Создавайте контрольные точки перед важными изменениями:**
   - Перед обновлением зависимостей
   - Перед изменением структуры данных
   - Перед обновлением API
   - После стабильных релизов

2. **Используйте понятные имена тегов:**
   - `v1.0-stable` - стабильная версия
   - `v1.1-before-update` - перед обновлением
   - `backup-2024-01-15` - датированный бэкап

3. **Регулярно создавайте бэкапы прокси:**
   ```bash
   ./backup_proxy.sh
   ```

## Текущие контрольные точки

- `v1.0-stable` - Стабильная версия с единой таблицей и новым URL скрипта

## Восстановление

Если что-то пошло не так:

1. Посмотрите доступные теги: `git tag -l`
2. Откатитесь к нужной версии: `./restore_checkpoint.sh [тег]`
3. Проверьте работу приложения
4. Если нужно вернуться: `git checkout main`




